ASP.NET Core **GuId**entity
===

ASP.NET Core Identity by default uses string as primary key, using GuIdentity you will have guid as a primary key.

## Usage

Based in project generated by `dotnet new mvc --auth Individual`

1. Run in Package Manager Console:

	`dotnet add package Msmaldi.AspNetCore.GuIdentity.EntityFrameworkCore --version 2.0.0`

2. In file ApplicationUser.cs add and change:

	```csharp
	using Msmaldi.AspNetCore.GuIdentity;
	```
	```csharp
	public class ApplicationUser : GuIdentityUser
	```

3. In file ApplicationDbContext.cs add and change:

	```csharp
	using Msmaldi.AspNetCore.GuIdentity.EntityFrameworkCore;
	```
	```csharp
	public class ApplicationDbContext : GuIdentityDbContext<ApplicationUser>
	```

4. In file Startup.cs add and change:
	
	```csharp
	using Msmaldi.AspNetCore.GuIdentity;
	```
	```csharp
	services.AddIdentity<ApplicationUser, GuIdentityRole>()
                .AddEntityFrameworkStores<ApplicationDbContext>()
                .AddDefaultTokenProviders();
	```

5. In file UrlHelperExtensions.cs in methods EmailConfirmationLink and ResetPasswordCallbackLink change:

	`string userId`

	to:

	`Guid userId`

6. In file ManageController.cs line 269 change:

	`var info = await _signInManager.GetExternalLoginInfoAsync(user.Id);`

	to:

	`var info = await _signInManager.GetExternalLoginInfoAsync(user.Id.ToString());`


7. Delete app.db:

	`rm app.db`


8. Delete folder :

	`rm -r ./Data/Migrations`

9. Run:
	```
	dotnet ef migrations add CreateGuIdentityInitialSchema -o ./Data/Migrations

	dotnet ef database update

	dotnet run
	```